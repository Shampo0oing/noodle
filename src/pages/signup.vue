<template>
  <div class="signup-page">
    <div class="left-rect">
      <span class="logo">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="97"
          height="23"
          viewBox="0 0 97 23"
          fill="none"
        >
          <path
            d="M0.0400001 22V0.819999H3.34L4.75 5.05V22H0.0400001ZM14.65 22L2.17 6.01L3.34 0.819999L15.82 16.81L14.65 22ZM14.65 22L13.39 17.77V0.819999H18.1V22H14.65ZM62.5488 22.3C61.1688 22.3 59.9388 21.97 58.8588 21.31C57.7988 20.65 56.9588 19.75 56.3388 18.61C55.7388 17.47 55.4388 16.17 55.4388 14.71C55.4388 13.25 55.7388 11.95 56.3388 10.81C56.9588 9.67 57.7988 8.77 58.8588 8.11C59.9388 7.45 61.1688 7.12 62.5488 7.12C63.5488 7.12 64.4488 7.31 65.2488 7.69C66.0688 8.07 66.7388 8.6 67.2588 9.28C67.7988 9.94 68.0988 10.7 68.1588 11.56V17.71C68.0988 18.57 67.8088 19.35 67.2888 20.05C66.7688 20.73 66.0988 21.28 65.2788 21.7C64.4588 22.1 63.5488 22.3 62.5488 22.3ZM63.3588 18.16C64.0188 18.16 64.5888 18.02 65.0688 17.74C65.5488 17.44 65.9288 17.03 66.2088 16.51C66.4888 15.99 66.6288 15.39 66.6288 14.71C66.6288 14.03 66.4888 13.44 66.2088 12.94C65.9488 12.42 65.5688 12.01 65.0688 11.71C64.5888 11.41 64.0288 11.26 63.3888 11.26C62.7488 11.26 62.1788 11.41 61.6788 11.71C61.1988 12.01 60.8088 12.42 60.5088 12.94C60.2288 13.46 60.0888 14.05 60.0888 14.71C60.0888 15.37 60.2288 15.96 60.5088 16.48C60.7888 17 61.1788 17.41 61.6788 17.71C62.1788 18.01 62.7388 18.16 63.3588 18.16ZM70.9488 22H66.4488V18.07L67.1388 14.53L66.3588 10.99V0.22H70.9488V22ZM74.1805 22V0.22H78.7705V22H74.1805ZM89.2028 22.33C87.6228 22.33 86.2128 22.01 84.9728 21.37C83.7528 20.71 82.7928 19.8 82.0928 18.64C81.3928 17.48 81.0428 16.17 81.0428 14.71C81.0428 13.25 81.3828 11.95 82.0628 10.81C82.7628 9.65 83.7028 8.74 84.8828 8.08C86.0628 7.42 87.3928 7.09 88.8728 7.09C90.3128 7.09 91.5828 7.4 92.6828 8.02C93.7828 8.64 94.6428 9.5 95.2628 10.6C95.9028 11.7 96.2228 12.96 96.2228 14.38C96.2228 14.64 96.2028 14.92 96.1628 15.22C96.1428 15.5 96.0928 15.83 96.0128 16.21L83.4428 16.24V13.09L94.0628 13.06L92.0828 14.38C92.0628 13.54 91.9328 12.85 91.6928 12.31C91.4528 11.75 91.0928 11.33 90.6128 11.05C90.1528 10.75 89.5828 10.6 88.9028 10.6C88.1828 10.6 87.5528 10.77 87.0128 11.11C86.4928 11.43 86.0828 11.89 85.7828 12.49C85.5028 13.09 85.3628 13.82 85.3628 14.68C85.3628 15.54 85.5128 16.28 85.8128 16.9C86.1328 17.5 86.5728 17.97 87.1328 18.31C87.7128 18.63 88.3928 18.79 89.1728 18.79C89.8928 18.79 90.5428 18.67 91.1228 18.43C91.7028 18.17 92.2128 17.79 92.6528 17.29L95.1728 19.81C94.4528 20.65 93.5828 21.28 92.5628 21.7C91.5428 22.12 90.4228 22.33 89.2028 22.33Z"
            fill="#5D4E5F"
          />
          <path
            d="M28.7884 22.33C27.2884 22.33 25.9284 22 24.7084 21.34C23.5084 20.66 22.5584 19.74 21.8584 18.58C21.1584 17.42 20.8084 16.12 20.8084 14.68C20.8084 13.24 21.1584 11.95 21.8584 10.81C22.5584 9.67 23.5084 8.77 24.7084 8.11C25.9084 7.43 27.2684 7.09 28.7884 7.09C30.3084 7.09 31.6684 7.42 32.8684 8.08C34.0684 8.74 35.0184 9.65 35.7184 10.81C36.4184 11.95 36.7684 13.24 36.7684 14.68C36.7684 16.12 36.4184 17.42 35.7184 18.58C35.0184 19.74 34.0684 20.66 32.8684 21.34C31.6684 22 30.3084 22.33 28.7884 22.33ZM28.7884 18.16C29.4484 18.16 30.0284 18.02 30.5284 17.74C31.0284 17.44 31.4084 17.03 31.6684 16.51C31.9484 15.97 32.0884 15.36 32.0884 14.68C32.0884 14 31.9484 13.41 31.6684 12.91C31.3884 12.39 30.9984 11.99 30.4984 11.71C30.0184 11.41 29.4484 11.26 28.7884 11.26C28.1484 11.26 27.5784 11.41 27.0784 11.71C26.5784 11.99 26.1884 12.39 25.9084 12.91C25.6284 13.43 25.4884 14.03 25.4884 14.71C25.4884 15.37 25.6284 15.97 25.9084 16.51C26.1884 17.03 26.5784 17.44 27.0784 17.74C27.5784 18.02 28.1484 18.16 28.7884 18.16ZM46.0736 22.33C44.5736 22.33 43.2136 22 41.9936 21.34C40.7936 20.66 39.8436 19.74 39.1436 18.58C38.4436 17.42 38.0936 16.12 38.0936 14.68C38.0936 13.24 38.4436 11.95 39.1436 10.81C39.8436 9.67 40.7936 8.77 41.9936 8.11C43.1936 7.43 44.5536 7.09 46.0736 7.09C47.5936 7.09 48.9536 7.42 50.1536 8.08C51.3536 8.74 52.3036 9.65 53.0036 10.81C53.7036 11.95 54.0536 13.24 54.0536 14.68C54.0536 16.12 53.7036 17.42 53.0036 18.58C52.3036 19.74 51.3536 20.66 50.1536 21.34C48.9536 22 47.5936 22.33 46.0736 22.33ZM46.0736 18.16C46.7336 18.16 47.3136 18.02 47.8136 17.74C48.3136 17.44 48.6936 17.03 48.9536 16.51C49.2336 15.97 49.3736 15.36 49.3736 14.68C49.3736 14 49.2336 13.41 48.9536 12.91C48.6736 12.39 48.2836 11.99 47.7836 11.71C47.3036 11.41 46.7336 11.26 46.0736 11.26C45.4336 11.26 44.8636 11.41 44.3636 11.71C43.8636 11.99 43.4736 12.39 43.1936 12.91C42.9136 13.43 42.7736 14.03 42.7736 14.71C42.7736 15.37 42.9136 15.97 43.1936 16.51C43.4736 17.03 43.8636 17.44 44.3636 17.74C44.8636 18.02 45.4336 18.16 46.0736 18.16Z"
            fill="#C8E4F0"
          />
        </svg>
      </span>
      <div class="login-rect">
        <div class="main-text">
          <span class="title">Bienvenue</span>
          <span class="text"
            >Entrer vos information afin de creer un compte!</span
          >
        </div>
        <div class="main-inputs">
          <div class="input-box">
            <div class="box">
              <span class="input-text">Username</span>
              <v-text-field
                v-model="state.username"
                label="entrer le Username"
                single-line
                outlined
                rounded
                full-width
                dense
                hide-details
                height="45"
              ></v-text-field>
              <span v-if="v$.username.$error" class="error">{{
                v$.username.$errors[0].$message
              }}</span>
            </div>
            <div class="box">
              <span class="input-text">Email</span>
              <v-text-field
                v-model="state.email"
                label="entrer le Email"
                single-line
                outlined
                rounded
                full-width
                dense
                hide-details
                height="45"
              ></v-text-field>
              <span v-if="v$.email.$error" class="error">{{
                v$.email.$errors[0].$message
              }}</span>
            </div>
            <div class="box-password">
              <div class="box">
                <span class="input-text">Mot de passe</span>
                <v-text-field
                  v-model="state.password"
                  label="entrer le Mot de passe"
                  single-line
                  outlined
                  rounded
                  full-width
                  dense
                  hide-details
                  height="45"
                  type="password"
                ></v-text-field>
                <span v-if="v$.password.$error" class="error">{{
                  v$.password.$errors[0].$message
                }}</span>
              </div>
              <div class="box">
                <v-text-field
                  v-model="state.confirmed"
                  label="Verifier votre mot de passe"
                  single-line
                  outlined
                  rounded
                  full-width
                  dense
                  hide-details
                  height="45"
                  type="password"
                ></v-text-field>
                <span v-if="v$.confirmed.$error" class="error">{{
                  v$.confirmed.$errors[0].$message
                }}</span>
              </div>
            </div>
          </div>
          <v-btn
            v-on:click="sendForm"
            rounded
            style="
              height: 40px;
              width: 420px;
              border-radius: 8px;
              background-color: #c8e4f0;
              color: #5d4e5f;
            "
            >creer le compte</v-btn
          >
        </div>
      </div>
    </div>
    <div class="right-rect"></div>
  </div>
</template>

<script>
import useValidate from "@vuelidate/core";
import { required, email, minLength, sameAs } from "@vuelidate/validators";
import { reactive, computed } from "vue";
import router from "../router";
export default {
  name: "sign-up",
  setup() {
    const state = reactive({
      username: null,
      email: null,
      password: null,
      confirmed: null,
    });

    const rules = computed(() => {
      return {
        username: { required },
        email: { required, email },
        password: { required, minLength: minLength(6) },
        confirmed: { required, sameAs: sameAs(state.password) },
      };
    });
    const v$ = useValidate(rules, state);
    return {
      state,
      v$,
    };
  },
  methods: {
    sendForm() {
      this.v$.$validate();
      if (!this.v$.$error) {
        fetch("http://localhost:8080/users/sign-up", {
          method: "POST",
          credentials: "include",
          headers: {
            Accept: "application/json",
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            username: this.state.username,
            email: this.state.email,
            password: this.state.password,
          }),
        })
          .then((res) => {
            if (res.status === 200) {
              router.push({ name: "Schedule" });
            }
          })
          .catch((err) => {
            console.error(err);
          })
          .finally(() => (this.isLoading = false));
      }
    },
  },
};
</script>

<style scoped lang="scss">
@import url("https://fonts.googleapis.com/css2?family=Outfit&display=swap");
.signup-page {
  font-family: Outfit, sans-serif;
  display: flex;
  flex-direction: row;
}
.left-rect,
.right-rect {
  height: 100vh;
  width: 100%;
}

.left-rect {
  background-color: #ffffff;
  .logo {
    margin: 32px 25% 0 6%;
    display: flex;
    justify-content: space-between;
  }
  .login-rect {
    display: flex;
    flex-direction: column;
    margin: 15% 25% 25% 25%;
    gap: 32px;
    .main-text {
      display: flex;
      flex-direction: column;
      gap: 24px;

      .title {
        font-weight: 700;
        font-size: 40px;
        line-height: 28px;
        color: #5d4e5f;
      }

      .text {
        font-size: 17px;
        line-height: 28px;
        width: 110%;
        text-transform: capitalize;
        color: rgba(63, 63, 63, 0.69);
      }
    }
    .main-inputs {
      display: flex;
      flex-direction: column;
      gap: 64px;
      .input-box {
        display: flex;
        flex-direction: column;
        gap: 12px;
        .box {
          display: flex;
          flex-direction: column;
          gap: 3px;
          .input-text {
            color: #3f3f3f;
            font-weight: 500;
            font-size: 14px;
            line-height: 28px;
          }
          .error {
            color: red;
            font-size: 12px;
            font-weight: 500;
          }
        }
        .box-password {
          display: flex;
          flex-direction: column;
          gap: 24px;
          .input-text {
            color: #3f3f3f;
            font-weight: 500;
            font-size: 14px;
            line-height: 28px;
          }
        }
      }
    }
  }
}

.right-rect {
  background-color: #c8e4f0;
}
.v-text-field--outlined {
  border-radius: 8px;
  width: 420px;
  opacity: 50%;
  color: #3f3f3f;
}
.v-btn {
  height: 40px;
}
</style>
